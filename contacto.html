<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comunícate Conmigo - Asesoría Laboral</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome para iconos consistentes -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" xintegrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Chosen Palette: Warm Neutrals & Professional Teal -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Estilo para el ícono grande encima del título de Información de Contacto */
        .contact-icon-large {
            font-size: 3.5rem; /* Tamaño del ícono, ajustado para ser grande */
            color: #047857; /* emerald-700, un poco más oscuro que el texto del título */
            margin-bottom: 0.5rem; /* Espacio debajo del ícono */
            display: block; /* Asegura que el ícono esté en su propia línea */
            width: 100%; /* Ocupa todo el ancho para centrado de texto */
        }
        /* Estilos para el mensaje de éxito/error */
        .message-box {
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
            font-weight: bold;
            display: none; /* Oculto por defecto */
        }
        .message-box.success {
            background-color: #d1fae5; /* green-100 */
            color: #065f46; /* green-800 */
            border: 1px solid #34d399; /* green-400 */
        }
        .message-box.error {
            background-color: #fee2e2; /* red-100 */
            color: #991b1b; /* red-800 */
            border: 1px solid #ef4444; /* red-400 */
        }
        .message-box.loading {
            background-color: #e0f2f7; /* light blue */
            color: #026670; /* dark cyan */
            border: 1px solid #4dd0e1; /* cyan */
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 min-h-screen flex flex-col">

    <!-- Placeholder para la barra de navegación -->
    <div id="navbar-placeholder"></div>

    <div class="flex-grow flex items-center justify-center p-4">
        <div class="bg-white p-8 md:p-12 rounded-xl shadow-xl max-w-3xl w-full text-center border border-teal-100">
            
            <h1 class="text-3xl md:text-4xl font-bold text-teal-800 mb-4">Comunícate Conmigo</h1>
            <p class="text-lg text-slate-600 mb-8">
                ¿Tienes preguntas, quieres agendar una sesión o simplemente deseas conversar? ¡Escríbeme!
            </p>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Sección de Formulario de Contacto -->
                <div class="p-6 bg-slate-50 rounded-lg shadow-inner border border-slate-200">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">Envíame un Mensaje</h2>
                    <!-- El 'action' del formulario será la URL de tu Apps Script para enviar emails -->
                    <!-- Se elimina el 'target="hidden_iframe"' porque ahora usaremos fetch -->
                    <form id="contact-form" action="https://script.google.com/macros/s/AKfycbxDs5E320g_KWSkGxvOFLlirdGs3U3PygKKkyACUbprgq6AeNqzpazuUKjTKSIM8lCg/exec" method="POST" class="space-y-4 text-left">
                        <div>
                            <label for="name" class="block text-slate-700 text-sm font-bold mb-2">Nombre:</label>
                            <input type="text" id="name" name="name" class="shadow appearance-none border rounded w-full py-2 px-3 text-slate-700 leading-tight focus:outline-none focus:shadow-outline focus:border-teal-500" placeholder="Tu Nombre" required>
                        </div>
                        <div>
                            <label for="email" class="block text-slate-700 text-sm font-bold mb-2">Email:</label>
                            <input type="email" id="email" name="email" class="shadow appearance-none border rounded w-full py-2 px-3 text-slate-700 leading-tight focus:outline-none focus:shadow-outline focus:border-teal-500" placeholder="tu.email@ejemplo.com" required>
                        </div>
                        <div>
                            <label for="subject" class="block text-slate-700 text-sm font-bold mb-2">Asunto:</label>
                            <input type="text" id="subject" name="subject" class="shadow appearance-none border rounded w-full py-2 px-3 text-slate-700 leading-tight focus:outline-none focus:shadow-outline focus:border-teal-500" placeholder="Asunto de tu mensaje" required>
                        </div>
                        <div>
                            <label for="message" class="block text-slate-700 text-sm font-bold mb-2">Mensaje:</label>
                            <textarea id="message" name="message" rows="5" class="shadow appearance-none border rounded w-full py-2 px-3 text-slate-700 leading-tight focus:outline-none focus:shadow-outline focus:border-teal-500" placeholder="Escribe tu mensaje aquí..." required></textarea>
                        </div>
                        <button type="submit" id="submit-button" class="bg-teal-600 text-white font-bold py-3 px-8 rounded-lg shadow-md hover:bg-teal-700 transition-transform transform hover:scale-105 w-full">
                            Enviar Mensaje
                        </button>
                    </form>
                    <!-- Contenedor para mensajes de éxito/error -->
                    <div id="form-message" class="message-box"></div>
                </div>

                <!-- Sección de Información de Contacto Directa -->
                <div class="p-6 bg-emerald-50 rounded-lg shadow-inner border border-emerald-200 flex flex-col items-center text-center">
                    <i class="fa-solid fa-address-card contact-icon-large"></i>
                    <h2 class="text-2xl font-bold text-emerald-800 mb-4">Información de Contacto</h2>
                    <p class="text-emerald-700 mb-4">También puedes contactarme directamente:</p>
                    <div class="space-y-4">
                        <div class="flex items-center justify-center space-x-3">
                            <i class="fa-solid fa-envelope text-emerald-600 text-xl"></i>
                            <a href="mailto:juan.jaccard.ps@gmail.com" class="text-emerald-700 hover:underline">juan.jaccard.ps@gmail.com</a>
                        </div>
                        <div class="flex items-center justify-center space-x-3">
                            <i class="fa-brands fa-linkedin text-emerald-600 text-xl"></i>
                            <a href="https://www.linkedin.com/in/jjaccard/" target="_blank" class="text-emerald-700 hover:underline">LinkedIn</a>
                        </div>
                    </div>
                    <p class="mt-6 text-sm text-emerald-600">
                        Responderé a la brevedad posible.
                    </p>
                </div>
            </div>

            <p class="mt-8 text-sm text-slate-500">
                © 2025 Juan José Jaccard. Todos los derechos reservados.
            </p>
        </div>
    </div>

    <script>
        // Función para cargar la barra de navegación
        async function loadNavbar() {
            try {
                // Corrección: Usar new URL() para asegurar que la ruta se parsea correctamente
                const response = await fetch(new URL('navbar.html', window.location.href)); 
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const navbarHtml = await response.text();
                document.getElementById('navbar-placeholder').innerHTML = navbarHtml;

                // Lógica del menú móvil (hamburguesa) debe ir aquí, después de que la navbar se haya cargado
                const mobileMenuButton = document.getElementById('mobile-menu-button');
                const mobileMenu = document.getElementById('mobile-menu');

                if (mobileMenuButton && mobileMenu) {
                    mobileMenuButton.addEventListener('click', function() {
                        mobileMenu.classList.toggle('hidden');
                    });
                } else {
                    console.warn("Botón o menú móvil no encontrados después de cargar la navbar. Asegúrate de que los IDs sean correctos en navbar.html.");
                }

            } catch (error) {
                console.error("Error al cargar la barra de navegación:", error);
                // Opcional: mostrar un mensaje de error en la página si la navbar no carga
            }
        }

        // Declarar las variables globalmente
        let contactForm;
        let formMessage;
        let submitButton;

        document.addEventListener('DOMContentLoaded', function() {
            // Cargar la barra de navegación primero
            loadNavbar();

            // Asignar los elementos a las variables globales una vez que el DOM esté cargado
            contactForm = document.getElementById('contact-form');
            formMessage = document.getElementById('form-message');
            submitButton = document.getElementById('submit-button');

            // Añadir el event listener para el envío del formulario
            contactForm.addEventListener('submit', async function(event) {
                event.preventDefault(); // Prevenir el envío por defecto del formulario

                // Mostrar mensaje de carga
                formMessage.textContent = 'Enviando mensaje...';
                formMessage.className = 'message-box loading';
                formMessage.style.display = 'block';
                submitButton.disabled = true; // Deshabilitar el botón para evitar envíos múltiples

                const formData = new FormData(contactForm);
                // Convertir FormData a URL-encoded string
                const urlEncodedData = new URLSearchParams(formData).toString();

                try {
                    const response = await fetch(contactForm.action, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/x-www-form-urlencoded'
                        },
                        body: urlEncodedData
                    });

                    // Si la respuesta HTTP no es OK, lanzar un error
                    if (!response.ok) {
                        throw new Error(`Error de red: ${response.status} ${response.statusText}`);
                    }

                    // Leer la respuesta como texto primero para depuración
                    const responseText = await response.text();
                    console.log("Respuesta raw del Apps Script:", responseText); // <-- ¡Esta es la línea clave para depurar!

                    const result = JSON.parse(responseText); // Intentar parsear la respuesta JSON

                    if (result.success) {
                        formMessage.textContent = '¡Mensaje enviado con éxito! Me pondré en contacto contigo a la brevedad.';
                        formMessage.className = 'message-box success';
                        contactForm.reset(); // Limpiar el formulario
                    } else {
                        formMessage.textContent = 'Error al enviar el mensaje: ' + (result.error || 'Inténtalo de nuevo.');
                        formMessage.className = 'message-box error';
                    }
                } catch (error) {
                    console.error("Error en el envío del formulario con fetch o parseo JSON:", error);
                    formMessage.textContent = 'Hubo un problema inesperado al enviar tu mensaje. Por favor, inténtalo de nuevo.';
                    formMessage.className = 'message-box error';
                } finally {
                    formMessage.style.display = 'block'; // Asegurar que el mensaje se muestre
                    submitButton.disabled = false; // Habilitar el botón de nuevo
                }
            });
        });
    </script>
</body>
</html>
